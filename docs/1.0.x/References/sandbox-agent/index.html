<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.0.x docs-doc-page docs-doc-id-References/sandbox-agent" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Sandbox Agent | ROCK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://alibaba.github.io/ROCK/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://alibaba.github.io/ROCK/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://alibaba.github.io/ROCK/docs/1.0.x/References/sandbox-agent"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.0.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.0.x"><meta data-rh="true" name="docsearch:version" content="1.0.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.0.x"><meta data-rh="true" property="og:title" content="Sandbox Agent | ROCK"><meta data-rh="true" name="description" content="The Sandbox Agent is a component in the Self-ROCK framework for running AI agent tasks in an isolated environment, providing a secure and controllable agent execution environment. Agents can be integrated with Model Service to handle AI model calls."><meta data-rh="true" property="og:description" content="The Sandbox Agent is a component in the Self-ROCK framework for running AI agent tasks in an isolated environment, providing a secure and controllable agent execution environment. Agents can be integrated with Model Service to handle AI model calls."><link data-rh="true" rel="icon" href="/ROCK/img/logo.png"><link data-rh="true" rel="canonical" href="https://alibaba.github.io/ROCK/docs/1.0.x/References/sandbox-agent"><link data-rh="true" rel="alternate" href="https://alibaba.github.io/ROCK/docs/1.0.x/References/sandbox-agent" hreflang="en"><link data-rh="true" rel="alternate" href="https://alibaba.github.io/ROCK/zh-Hans/docs/1.0.x/References/sandbox-agent" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://alibaba.github.io/ROCK/docs/1.0.x/References/sandbox-agent" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-26LMNFB70V"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-26LMNFB70V",{anonymize_ip:!0})</script><link rel="stylesheet" href="/ROCK/assets/css/styles.0163343e.css">
<script src="/ROCK/assets/js/runtime~main.f25a363c.js" defer="defer"></script>
<script src="/ROCK/assets/js/main.bbfb8e37.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/ROCK/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ROCK/"><div class="navbar__logo"><img src="/ROCK/img/logo.png" alt="ROCK" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ROCK/img/logo.png" alt="ROCK" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ROCK</b></a><a class="navbar__item navbar__link" href="/ROCK/docs/1.0.x/overview">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/ROCK/docs/1.0.x/References/sandbox-agent">1.0.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ROCK/docs/overview">0.2.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/ROCK/docs/1.0.x/References/sandbox-agent">1.0.x</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/ROCK/docs/1.0.x/References/sandbox-agent" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/ROCK/zh-Hans/docs/1.0.x/References/sandbox-agent" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://deepwiki.com/alibaba/ROCK" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DeepWiki<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/alibaba/ROCK" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 1.0.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Sandbox Agent</h1></header>
<p>The Sandbox Agent is a component in the Self-ROCK framework for running AI agent tasks in an isolated environment, providing a secure and controllable agent execution environment. Agents can be integrated with Model Service to handle AI model calls.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="architecture-overview">Architecture Overview<a href="#architecture-overview" class="hash-link" aria-label="Direct link to Architecture Overview" title="Direct link to Architecture Overview" translate="no">​</a></h2>
<p>The sandbox agent initializes and executes agent tasks in an isolated sandbox environment, including installing necessary dependencies, configuring the runtime environment, and other steps. The agent system supports multiple different agent types, such as SWE-agent and IFlow CLI, each with specific configurations and implementations.</p>
<p>Agents can be integrated with Model Service to handle AI model calls during task execution. When agents need to query or call AI models, the model service processes model communications in the background, allowing agents to focus on task execution.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="model-service-integration-capability">Model Service Integration Capability<a href="#model-service-integration-capability" class="hash-link" aria-label="Direct link to Model Service Integration Capability" title="Direct link to Model Service Integration Capability" translate="no">​</a></h2>
<p>Sandbox agents support seamless integration with Model Service, providing a communication bridge for AI model calls. This integration allows agents to interact with Model Service through file system communication protocol, enabling asynchronous request-response mechanisms.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="integration-methods">Integration Methods<a href="#integration-methods" class="hash-link" aria-label="Direct link to Integration Methods" title="Direct link to Integration Methods" translate="no">​</a></h3>
<ul>
<li class=""><strong>Configuration-driven</strong>: Specify Model Service through <code>model_service_config</code> parameter in the agent configuration</li>
<li class=""><strong>Parallel Initialization</strong>: Model Service installation process executes in parallel with agent installation</li>
<li class=""><strong>Dynamic Start</strong>: Model Service can be started on-demand during task execution</li>
<li class=""><strong>Process Monitoring</strong>: Monitor agent processes through <code>watch-agent</code> command</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="modelserviceconfig-properties">ModelServiceConfig Properties<a href="#modelserviceconfig-properties" class="hash-link" aria-label="Direct link to ModelServiceConfig Properties" title="Direct link to ModelServiceConfig Properties" translate="no">​</a></h3>
<ul>
<li class=""><code>workdir</code>: Model Service working directory</li>
<li class=""><code>python_install_cmd</code>: Python environment installation command</li>
<li class=""><code>model_service_install_cmd</code>: Model Service installation command</li>
<li class=""><code>python_install_timeout</code>: Python installation timeout</li>
<li class=""><code>model_service_install_timeout</code>: Model Service installation timeout</li>
<li class=""><code>model_service_type</code>: Model Service type (local/proxy)</li>
<li class=""><code>model_service_session</code>: Service session name</li>
<li class=""><code>start_cmd</code>, <code>stop_cmd</code>, <code>watch_agent_cmd</code>: Control command templates</li>
<li class=""><code>anti_call_llm_cmd</code>: Anti-call LLM command</li>
<li class=""><code>logging_path</code>: Log path</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="core-components">Core Components<a href="#core-components" class="hash-link" aria-label="Direct link to Core Components" title="Direct link to Core Components" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-agent-abstract-base-class">1. Agent Abstract Base Class<a href="#1-agent-abstract-base-class" class="hash-link" aria-label="Direct link to 1. Agent Abstract Base Class" title="Direct link to 1. Agent Abstract Base Class" translate="no">​</a></h3>
<p>Located in <code>rock/sdk/sandbox/agent/base.py</code>, defines the abstract base class for all sandbox agents:</p>
<ul>
<li class=""><code>__init__()</code>: Initialize the agent with sandbox instance and optional model service</li>
<li class=""><code>init()</code>: Asynchronously initialize the agent environment</li>
<li class=""><code>run()</code>: Asynchronously execute agent tasks</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-agentconfig-abstract-configuration-class">2. AgentConfig Abstract Configuration Class<a href="#2-agentconfig-abstract-configuration-class" class="hash-link" aria-label="Direct link to 2. AgentConfig Abstract Configuration Class" title="Direct link to 2. AgentConfig Abstract Configuration Class" translate="no">​</a></h3>
<p>Located in <code>rock/sdk/sandbox/agent/config.py</code>, defines the basic configuration for agents:</p>
<ul>
<li class=""><code>agent_type</code>: Agent type identifier</li>
<li class=""><code>version</code>: Version information</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="specific-agent-implementations">Specific Agent Implementations<a href="#specific-agent-implementations" class="hash-link" aria-label="Direct link to Specific Agent Implementations" title="Direct link to Specific Agent Implementations" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="swe-agent">SWE-agent<a href="#swe-agent" class="hash-link" aria-label="Direct link to SWE-agent" title="Direct link to SWE-agent" translate="no">​</a></h3>
<p>Implemented based on the <code>Agent</code> base class, specifically designed to handle software engineering tasks.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sweagentconfig-configuration">SweAgentConfig Configuration<a href="#sweagentconfig-configuration" class="hash-link" aria-label="Direct link to SweAgentConfig Configuration" title="Direct link to SweAgentConfig Configuration" translate="no">​</a></h4>
<ul>
<li class=""><code>agent_type</code>: Fixed to &quot;swe-agent&quot;</li>
<li class=""><code>default_run_single_config</code>: Default runtime configuration</li>
<li class=""><code>agent_session</code>: Name of the bash session for agent execution</li>
<li class=""><code>pre_startup_bash_cmd_list</code>: List of commands to execute before startup</li>
<li class=""><code>post_startup_bash_cmd_list</code>: List of commands to execute after startup</li>
<li class=""><code>swe_agent_workdir</code>: Agent working directory</li>
<li class=""><code>python_install_cmd</code>: Python environment installation command</li>
<li class=""><code>swe_agent_install_cmd</code>: SWE-agent installation command</li>
<li class=""><code>python_install_timeout</code>: Python installation timeout duration</li>
<li class=""><code>swe_agent_install_timeout</code>: SWE-agent installation timeout duration</li>
<li class=""><code>agent_run_timeout</code>: Agent runtime timeout duration</li>
<li class=""><code>agent_run_check_interval</code>: Agent runtime check interval</li>
<li class=""><code>model_service_config</code>: Optional model service configuration</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sweagent-implementation">SweAgent Implementation<a href="#sweagent-implementation" class="hash-link" aria-label="Direct link to SweAgent Implementation" title="Direct link to SweAgent Implementation" translate="no">​</a></h4>
<ul>
<li class=""><code>init()</code>: Initialize SWE-agent environment, including installing Python environment, SWE-agent dependencies, and optional model service</li>
<li class=""><code>run()</code>: Execute specified software engineering tasks</li>
<li class=""><code>start_model_service()</code>: Start the associated model service</li>
<li class=""><code>_install_swe_agent()</code>: Install the SWE-agent environment</li>
<li class=""><code>_init_model_service()</code>: Initialize the model service</li>
<li class=""><code>_agent_run()</code>: Execute agent commands</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="iflow-cli-agent">IFlow CLI Agent<a href="#iflow-cli-agent" class="hash-link" aria-label="Direct link to IFlow CLI Agent" title="Direct link to IFlow CLI Agent" translate="no">​</a></h3>
<p>Implemented based on the <code>Agent</code> base class, handles command-line-based agent tasks.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="iflowcliconfig-configuration">IFlowCliConfig Configuration<a href="#iflowcliconfig-configuration" class="hash-link" aria-label="Direct link to IFlowCliConfig Configuration" title="Direct link to IFlowCliConfig Configuration" translate="no">​</a></h4>
<ul>
<li class=""><code>agent_type</code>: Fixed to &quot;iflow-cli&quot;</li>
<li class=""><code>agent_session</code>: Name of the bash session for agent execution</li>
<li class=""><code>pre_startup_bash_cmd_list</code>: List of commands to execute before startup</li>
<li class=""><code>npm_install_cmd</code>: NPM installation command</li>
<li class=""><code>npm_install_timeout</code>: NPM installation timeout duration</li>
<li class=""><code>iflow_cli_install_cmd</code>: IFlow CLI installation command</li>
<li class=""><code>iflow_settings</code>: IFlow configuration settings</li>
<li class=""><code>iflow_run_cmd</code>: Execution command template</li>
<li class=""><code>iflow_log_file</code>: IFlow log file path</li>
<li class=""><code>session_envs</code>: Session environment variables</li>
<li class=""><code>model_service_config</code>: Optional model service configuration</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="iflowcli-implementation">IFlowCli Implementation<a href="#iflowcli-implementation" class="hash-link" aria-label="Direct link to IFlowCli Implementation" title="Direct link to IFlowCli Implementation" translate="no">​</a></h4>
<ul>
<li class=""><code>init()</code>: Initialize IFlow CLI environment, including installing Node.js, IFlow CLI, and optional model service</li>
<li class=""><code>run()</code>: Run the IFlow CLI with a specified problem statement</li>
<li class=""><code>start_model_service()</code>: Start the associated model service</li>
<li class=""><code>_install_iflow_cli()</code>: Install the IFlow CLI environment</li>
<li class=""><code>_init_model_service()</code>: Initialize the model service</li>
<li class=""><code>_extract_session_id_from_log()</code>: Extract session ID from log</li>
<li class=""><code>_get_session_id_from_sandbox()</code>: Retrieve session ID from sandbox</li>
<li class=""><code>_agent_run()</code>: Execute agent commands</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="initialization-process">Initialization Process<a href="#initialization-process" class="hash-link" aria-label="Direct link to Initialization Process" title="Direct link to Initialization Process" translate="no">​</a></h2>
<ol>
<li class="">Create sandbox environment and agent instance</li>
<li class="">Call <code>init()</code> method to initialize the agent</li>
<li class="">Create dedicated bash session in the sandbox</li>
<li class="">Execute pre-startup commands (such as environment configuration)</li>
<li class="">Install necessary dependencies (Python, Node.js, etc.)</li>
<li class="">Install specific agent tools (such as SWE-agent or IFlow CLI)</li>
<li class="">If model service is configured, initialize model service in parallel</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="execution-process">Execution Process<a href="#execution-process" class="hash-link" aria-label="Direct link to Execution Process" title="Direct link to Execution Process" translate="no">​</a></h2>
<ol>
<li class="">Prepare task execution parameters (problem statement, project path, etc.)</li>
<li class="">Call <code>run()</code> method to execute the task</li>
<li class="">Prepare configuration files required for the task</li>
<li class="">Upload configuration files to the sandbox environment</li>
<li class="">Execute agent command</li>
<li class="">If model service is configured, monitor the agent process</li>
<li class="">Wait for task completion and return results</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="model-service-interaction-flow">Model Service Interaction Flow<a href="#model-service-interaction-flow" class="hash-link" aria-label="Direct link to Model Service Interaction Flow" title="Direct link to Model Service Interaction Flow" translate="no">​</a></h2>
<p>When agents are integrated with Model Service, the workflow is:</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="before-task-start">Before Task Start<a href="#before-task-start" class="hash-link" aria-label="Direct link to Before Task Start" title="Direct link to Before Task Start" translate="no">​</a></h3>
<ol>
<li class="">Call <code>start_model_service()</code> to start Model Service</li>
<li class="">Call <code>watch_agent()</code> to set up monitoring for the agent process</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="when-agent-calls-llm">When Agent Calls LLM<a href="#when-agent-calls-llm" class="hash-link" aria-label="Direct link to When Agent Calls LLM" title="Direct link to When Agent Calls LLM" translate="no">​</a></h3>
<ol>
<li class="">Agent initiates model call request</li>
<li class="">Request is written to log file via file communication protocol</li>
<li class="">Model Service listener captures the request</li>
<li class="">Actual AI model returns response</li>
<li class="">Response is written back via file communication protocol</li>
<li class="">Agent reads response and continues execution</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="after-task-completion">After Task Completion<a href="#after-task-completion" class="hash-link" aria-label="Direct link to After Task Completion" title="Direct link to After Task Completion" translate="no">​</a></h3>
<ol>
<li class="">If needed, stop Model Service process</li>
<li class="">Clean up related resources</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="workflow">Workflow<a href="#workflow" class="hash-link" aria-label="Direct link to Workflow" title="Direct link to Workflow" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="initialization-phase">Initialization Phase<a href="#initialization-phase" class="hash-link" aria-label="Direct link to Initialization Phase" title="Direct link to Initialization Phase" translate="no">​</a></h3>
<ol>
<li class="">Create sandbox dedicated session</li>
<li class="">Execute environment pre-configuration commands</li>
<li class="">Create working directory</li>
<li class="">Install runtime environment (Python/Node.js)</li>
<li class="">Install specific agent tools</li>
<li class="">Optional: Initialize model service</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-execution-phase">Task Execution Phase<a href="#task-execution-phase" class="hash-link" aria-label="Direct link to Task Execution Phase" title="Direct link to Task Execution Phase" translate="no">​</a></h3>
<ol>
<li class="">Receive task parameters: problem description, codebase path, etc.</li>
<li class="">Generate and upload task-specific configuration</li>
<li class="">Execute agent command</li>
<li class="">Optional: Start agent monitoring (if model service is configured)</li>
<li class="">Wait for processing completion</li>
<li class="">Collect and return execution results</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration-options">Configuration Options<a href="#configuration-options" class="hash-link" aria-label="Direct link to Configuration Options" title="Direct link to Configuration Options" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="general-agent-configuration">General Agent Configuration<a href="#general-agent-configuration" class="hash-link" aria-label="Direct link to General Agent Configuration" title="Direct link to General Agent Configuration" translate="no">​</a></h3>
<ul>
<li class=""><code>agent_session</code>: Name of the bash session for agent execution</li>
<li class=""><code>pre_startup_bash_cmd_list</code>: List of commands to execute before startup</li>
<li class=""><code>session_envs</code>: Session environment variables configuration</li>
<li class=""><code>model_service_config</code>: Model service configuration (optional)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="swe-agent-specific-configuration">SWE-agent Specific Configuration<a href="#swe-agent-specific-configuration" class="hash-link" aria-label="Direct link to SWE-agent Specific Configuration" title="Direct link to SWE-agent Specific Configuration" translate="no">​</a></h3>
<ul>
<li class=""><code>swe_agent_workdir</code>: SWE-agent working directory</li>
<li class=""><code>python_install_cmd</code>: Python installation command</li>
<li class=""><code>swe_agent_install_cmd</code>: SWE-agent installation command</li>
<li class=""><code>default_run_single_config</code>: Default runtime configuration</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="iflow-cli-specific-configuration">IFlow CLI Specific Configuration<a href="#iflow-cli-specific-configuration" class="hash-link" aria-label="Direct link to IFlow CLI Specific Configuration" title="Direct link to IFlow CLI Specific Configuration" translate="no">​</a></h3>
<ul>
<li class=""><code>npm_install_cmd</code>: NPM installation command</li>
<li class=""><code>iflow_cli_install_cmd</code>: IFlow CLI installation command</li>
<li class=""><code>iflow_settings</code>: IFlow settings</li>
<li class=""><code>iflow_run_cmd</code>: Execution command template</li>
<li class=""><code>iflow_log_file</code>: Log file path</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/alibaba/ROCK/tree/master/docs/rock/versioned_docs/version-1.0.x/References/sandbox-agent.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2026-01-04T03:38:29.000Z" itemprop="dateModified">Jan 4, 2026</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#architecture-overview" class="table-of-contents__link toc-highlight">Architecture Overview</a></li><li><a href="#model-service-integration-capability" class="table-of-contents__link toc-highlight">Model Service Integration Capability</a><ul><li><a href="#integration-methods" class="table-of-contents__link toc-highlight">Integration Methods</a></li><li><a href="#modelserviceconfig-properties" class="table-of-contents__link toc-highlight">ModelServiceConfig Properties</a></li></ul></li><li><a href="#core-components" class="table-of-contents__link toc-highlight">Core Components</a><ul><li><a href="#1-agent-abstract-base-class" class="table-of-contents__link toc-highlight">1. Agent Abstract Base Class</a></li><li><a href="#2-agentconfig-abstract-configuration-class" class="table-of-contents__link toc-highlight">2. AgentConfig Abstract Configuration Class</a></li></ul></li><li><a href="#specific-agent-implementations" class="table-of-contents__link toc-highlight">Specific Agent Implementations</a><ul><li><a href="#swe-agent" class="table-of-contents__link toc-highlight">SWE-agent</a></li><li><a href="#iflow-cli-agent" class="table-of-contents__link toc-highlight">IFlow CLI Agent</a></li></ul></li><li><a href="#initialization-process" class="table-of-contents__link toc-highlight">Initialization Process</a></li><li><a href="#execution-process" class="table-of-contents__link toc-highlight">Execution Process</a></li><li><a href="#model-service-interaction-flow" class="table-of-contents__link toc-highlight">Model Service Interaction Flow</a><ul><li><a href="#before-task-start" class="table-of-contents__link toc-highlight">Before Task Start</a></li><li><a href="#when-agent-calls-llm" class="table-of-contents__link toc-highlight">When Agent Calls LLM</a></li><li><a href="#after-task-completion" class="table-of-contents__link toc-highlight">After Task Completion</a></li></ul></li><li><a href="#workflow" class="table-of-contents__link toc-highlight">Workflow</a><ul><li><a href="#initialization-phase" class="table-of-contents__link toc-highlight">Initialization Phase</a></li><li><a href="#task-execution-phase" class="table-of-contents__link toc-highlight">Task Execution Phase</a></li></ul></li><li><a href="#configuration-options" class="table-of-contents__link toc-highlight">Configuration Options</a><ul><li><a href="#general-agent-configuration" class="table-of-contents__link toc-highlight">General Agent Configuration</a></li><li><a href="#swe-agent-specific-configuration" class="table-of-contents__link toc-highlight">SWE-agent Specific Configuration</a></li><li><a href="#iflow-cli-specific-configuration" class="table-of-contents__link toc-highlight">IFlow CLI Specific Configuration</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ROCK/docs/overview">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/ROCK/docs/Getting Started/quickstart">Quick Start</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/alibaba/ROCK" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Alibaba.</div></div></div></footer></div>
</body>
</html>